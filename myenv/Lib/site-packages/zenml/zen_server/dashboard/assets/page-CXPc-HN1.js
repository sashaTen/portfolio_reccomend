import{r as i,j as e}from"./@radix-DeK6qiuw.js";import{b as h,u as D,a as v,S,E as C}from"./SecretTooltip-EKpMlG2f.js";import{a as f,c as N}from"./@tanstack-DT5WLu9C.js";import{am as b,aB as w,an as E,aC as k,ao as T,I as j,aD as A,aq as K,f as p,D as V,w as O,x as B,S as L,ad as q,ae as z,L as F,o as I,B as Q}from"./index-CxO6541P.js";import{C as R}from"./CopyButton-DCiXO3JC.js";import{S as P}from"./key-icon-aH-QIa5R.js";import{S as H}from"./dots-horizontal-otGBOSDJ.js";import{S as M}from"./trash-arLUMWMS.js";import{A as _}from"./AlertDialogDropdownItem-8yPFDxEI.js";import{g as $}from"./@react-router-B3Z5rLr2.js";import"./plus-tf1V2hTJ.js";import"./url-BWJXzuI4.js";import"./zod-BwEbpOxH.js";import"./index.esm-Dy6Z9Ung.js";import"./CodeSnippet-Qh1ae_DJ.js";import"./copy-C8XQA2Ug.js";import"./@reactflow-6JPoencd.js";function U({secretId:s,keyName:r}){const{data:t,isLoading:a,isError:u}=f({...h.secretDetail(s)}),l=N(),{mutate:o}=D({onError(d){b(d)&&w({status:"error",emphasis:"subtle",description:d.message,rounded:!0})},onSuccess(){l.invalidateQueries({queryKey:["secrets"]}),l.invalidateQueries({queryKey:["secretDetail",s]})}}),[n,m]=i.useState(""),x=()=>{var d;if(t){const g={...(d=t.body)==null?void 0:d.values};delete g[r];const y={name:t.name,scope:"workspace",values:g};o({id:s,body:y})}};function c(d){m(d.target.value)}return a?e.jsx("div",{children:"Loading..."}):u?e.jsx("div",{children:"Error loading secret details"}):e.jsxs(E,{children:[e.jsx(k,{children:e.jsx(T,{children:"Delete Key"})}),e.jsxs("div",{className:"gap-5 p-5",children:[e.jsx("p",{className:"text-text-md text-theme-text-secondary",children:"Are you sure you want to delete this key?"}),e.jsx("p",{className:"text-text-md text-theme-text-secondary",children:"This action cannot be undone."}),e.jsx("h3",{className:"font-inter text-sm mb-1 mt-4 text-left font-medium leading-5",children:"Please type DELETE to confirm"}),e.jsx(j,{name:"key",onChange:c,className:"w-full",required:!0,value:n})]}),e.jsxs(A,{className:"gap-[10px]",children:[e.jsx(K,{asChild:!0,children:e.jsx(p,{size:"sm",intent:"secondary",children:"Cancel"})}),e.jsx(p,{intent:"danger",type:"button",onClick:x,disabled:n!=="DELETE",children:"Delete"})]})]})}function G({secretId:s,keyName:r}){const[t,a]=i.useState(!1),[u,l]=i.useState(!1),o=i.useRef(null),n=i.useRef(null);function m(){n.current=o.current}function x(c){if(c===!1){a(!1),setTimeout(()=>{l(c)},200);return}l(c)}return e.jsxs(V,{onOpenChange:a,open:t,children:[e.jsx(O,{ref:o,children:e.jsx(H,{className:"h-4 w-4 fill-theme-text-tertiary"})}),e.jsx(B,{hidden:u,onCloseAutoFocus:c=>{n.current&&(n.current.focus(),n.current=null,c.preventDefault())},align:"end",sideOffset:7,children:e.jsx(_,{onSelect:m,onOpenChange:x,triggerChildren:"Delete ",icon:e.jsx(M,{}),children:e.jsx(U,{secretId:s,keyName:r})})})]})}const J=({value:s})=>{const[r,t]=i.useState(!1),a=typeof s=="string"?s:"",u="â€¢".repeat(a.length);return e.jsxs("div",{className:"flex  items-center gap-2 space-x-2",children:[e.jsx(S,{onClick:()=>t(!r),className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:r?a:u})]})};function W(s,r){return[{id:"key",header:"Key",accessorKey:"key",cell:({row:t})=>{const a=`from zenml.client import Client
secret = Client().get_secret("${r}")
	  
# 'secret.secret_values' will contain a dictionary with all key-value pairs within your secret.
secret.secret_values["${t.original.key}"]
	  `;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-5 w-5 flex-shrink-0 fill-primary-400"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-text-md font-semibold text-theme-text-primary",children:t.original.key}),e.jsx(v,{code:a})]})})})]})}},{id:"value",header:"Value",accessorKey:"value",cell:({row:t})=>e.jsx(J,{value:t.getValue("value")})},{id:"actions",header:"",cell:({row:t})=>e.jsx(G,{secretId:s,keyName:t.original.key})}]}function X({secretId:s}){var o;const[r,t]=i.useState(""),a=f({...h.secretDetail(s)});if(a.isPending)return e.jsx(L,{className:"h-[200px] w-full"});if(a.isError)return e.jsx("div",{children:a.error.message});const l=Object.entries(((o=a.data.body)==null?void 0:o.values)||{}).map(([n,m])=>({key:n,value:m})).filter(n=>n.key.toLowerCase().includes(r.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-2",children:[e.jsx(j,{type:"text",placeholder:"Search Keys...",value:r,onChange:n=>t(n.target.value),inputSize:"md"}),e.jsxs(q,{children:[e.jsx(z,{asChild:!0,children:e.jsx(p,{size:"sm",intent:"primary",children:"Edit Keys"})}),e.jsx(C,{secretId:s,isSecretNameEditable:!1,dialogTitle:"Edit keys"})]})]}),e.jsx("div",{className:"w-full",children:e.jsx(F,{columns:W(s,a.data.name),data:l})})]})}function he(){const{secretId:s}=$(),{setCurrentBreadcrumbData:r}=I(),{data:t}=f({...h.secretDetail(s||"")});return i.useEffect(()=>{t&&r({segment:"secretsDetail",data:{name:t.name,id:t.id}})},[t]),e.jsx(e.Fragment,{children:e.jsxs(Q,{className:"space-y-5 p-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-text-xl font-semibold",children:t==null?void 0:t.name}),e.jsxs("div",{className:"group/copybutton flex items-center space-x-1",children:[e.jsx("div",{className:"text-theme-text-secondary",children:s==null?void 0:s.slice(0,8)}),e.jsx(R,{copyText:s})]})]}),e.jsx(X,{secretId:s||""})]})})}export{he as default};
